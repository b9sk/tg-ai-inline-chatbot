# Telegram Inline AI Bot

---

## 

1. [–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä](backend/README.md)

---

## 1. –ò–¥–µ—è

–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç **–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ inline-—Ä–µ–∂–∏–º–µ**:

```
@botname prompt
```

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∑–∞–ø—Ä–æ—Å –ø—Ä—è–º–æ –≤ Telegram, –∞ –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –≤ —Ç–æ–º –∂–µ —á–∞—Ç–µ.
–¶–µ–ª—å ‚Äî –ª—ë–≥–∫–∏–π, –±—ã—Å—Ç—Ä—ã–π –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ–∑–±–∞–∑–æ–≤—ã–π AI-–±–æ—Ç –Ω–∞ —Å–≤—è–∑–∫–µ **Flowise + Gemini API**, —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º backend.

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
graph LR
  A[Telegram] -->|Webhook| B[Cloudflare Worker]
  B -->|HTTP| C[Backend (Serverless API)]
  C -->|REST| D[Flowise]
  D -->|–û—Ç–≤–µ—Ç| C
  C -->|–û—Ç–≤–µ—Ç JSON| B
  B -->|sendMessage / answerInlineQuery| A
```

### –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

1. Telegram –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook ‚Üí **Cloudflare Worker**
2. Worker –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å ‚Üí **Backend API**
3. Backend:

   * —Å–æ–∑–¥–∞—ë—Ç `sessionId`;
   * –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ **Flowise**.
4. –û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ —Ü–µ–ø–æ—á–∫–µ –Ω–∞–∑–∞–¥.

### –†–æ–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                      | –†–æ–ª—å                                                           | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ                                                   |
| ------------------------------ | -------------------------------------------------------------- | ------------------------------------------------------------ |
| **Telegram API**               | –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–æ–±—ã—Ç–∏–π (`inline_query`, `message`, `callback_query`) | —Ç—Ä–µ–±—É–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π HTTPS endpoint                             |
| **Cloudflare Worker**          | –ø—Ä–∏–Ω–∏–º–∞–µ—Ç webhook, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –∏ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ               | –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã, –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ |
| **Backend (Node.js / Python)** | —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–æ—Å–ª–æ–π–∫–∞: —Å–æ–∑–¥–∞—ë—Ç `sessionId`, –≤—ã–∑—ã–≤–∞–µ—Ç Flowise   | –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–Ω–æ–π serverless-—Ñ—É–Ω–∫—Ü–∏–µ–π                         |
| **Flowise**                    | —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏ –≤—ã–∑—ã–≤–∞–µ—Ç Gemini API                     | –Ω–µ —Ö—Ä–∞–Ω–∏—Ç —á–∞—Ç—ã, –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –∏–∑ `sessionId`                      |

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

* **–ë–µ–∑ –ë–î** ‚Äî –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ Flowise.
* **Stateless backend** ‚Äî —Å–µ—Ä–≤–µ—Ä –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –±–µ–∑ –ø–æ—Ç–µ—Ä—å.
* (TBD)**–î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç** ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* **Inline only** ‚Äî –±–æ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —á–∞—Ç-–±–æ—Ç.
* **–û–¥–∏–Ω sessionId –Ω–∞ inline-–∑–∞–ø—Ä–æ—Å**; reply –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å–µ—Å—Å–∏—é.

---

## üóÇ –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
telegram-inline-ai-bot/
‚îú‚îÄ‚îÄ worker/
‚îÇ   ‚îú‚îÄ‚îÄ worker.js               # Cloudflare Worker (webhook handler)
‚îÇ   ‚îú‚îÄ‚îÄ wrangler.toml           # –∫–æ–Ω—Ñ–∏–≥ –¥–µ–ø–ª–æ—è
‚îÇ   ‚îî‚îÄ‚îÄ .env                    # —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏ –∞–¥—Ä–µ—Å backend
‚îÇ
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ handler.js              # serverless-—Ñ—É–Ω–∫—Ü–∏—è (Node.js)
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ .env                    # Flowise config
‚îÇ
‚îî‚îÄ‚îÄ README.md
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram

1. –°–æ–∑–¥–∞–π –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather).
2. –í–≤–µ–¥–∏ –∫–æ–º–∞–Ω–¥—É:

   ```
   /setinline
   ```

   –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π inline-—Ä–µ–∂–∏–º.
3. –£—Å—Ç–∞–Ω–æ–≤–∏ webhook:

   ```
   https://api.telegram.org/bot<YOUR_TOKEN>/setWebhook?url=<YOUR_CLOUDFLARE_WORKER_URL>
   ```
4. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ –æ—Ç–≤–µ—Ç –ø—Ä–∏—à–ª–æ `{ "ok": true }`.

---

## –ü—Ä–∏–º–µ—Ä `.env` (–æ–±—â–µ–µ)

| –§–∞–π–ª           | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è         | –ó–Ω–∞—á–µ–Ω–∏–µ               |
| -------------- | ------------------ | ---------------------- |
| `worker/.env`  | `BOT_TOKEN`        | —Ç–æ–∫–µ–Ω Telegram         |
| `worker/.env`  | `BACKEND_URL`      | URL serverless backend |
| `backend/.env` | `FLOWISE_BASE_URL` | URL Flowise            |
| `backend/.env` | `FLOWISE_FLOW_ID`  | ID –ø–æ—Ç–æ–∫–∞ Flowise      |

---

## –î–µ–ø–ª–æ–π

1. –ó–∞–¥–µ–ø–ª–æ–π backend (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ Vercel ‚Üí –ø–æ–ª—É—á–∏—à—å URL –≤—Ä–æ–¥–µ `https://flowise-backend.vercel.app/api/flowise`).
2. –£–∫–∞–∂–∏ —ç—Ç–æ—Ç URL –≤ `worker/wrangler.toml`.
3. –î–µ–ø–ª–æ–π Worker:

   ```bash
   cd worker
   npx wrangler deploy
   ```
4. –£—Å—Ç–∞–Ω–æ–≤–∏ webhook:

   ```bash
   curl "https://api.telegram.org/bot<token>/setWebhook?url=<worker_url>"
   ```
5. –ü—Ä–æ–≤–µ—Ä—å:
   –í–≤–µ–¥–∏ –≤ Telegram `@botname –ø—Ä–∏–≤–µ—Ç` ‚Üí –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è inline-–æ—Ç–≤–µ—Ç.

